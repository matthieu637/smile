#!/bin/bash


trap sigusr1 SIGUSR1

sigusr1()
{
        rm -rf /dev/shm/sem.*
}


launch(){

index=$1
file="smile${index}.data"

for i in {1..900000}
do 
  episod=$i
  perf=`torcs -r ~/.torcs/config/dtmrace${index}.xml | grep REWARD | sed -e 's/^.*REWARD ://'`
  lsize=`cat /usr/local/share/games/torcs/$file | grep -ve '\([^0-9]\|^\)0\([.]\|<\)' | wc -l`
  echo "iter : $i | state learned : $lsize | simulated races :  $episod | perf : $perf"
done

}

if [ $# -lt 1 ] ; then
	echo "Usage : $0 <index>"
	# <cpu>"
else
  launch $1 # $2
fi



